<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Rekaman Live CCTV - SmartPJU Monitor</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/style.css') }}"
    />
  </head>
  <body>
    <!-- Hamburger Menu Button -->
    <button class="hamburger-btn" id="hamburger-btn">
      <span></span>
      <span></span>
      <span></span>
    </button>

    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebar-overlay"></div>

    <div class="main-container">
      <!-- Sidebar -->
      <aside class="sidebar" id="sidebar">
        <div class="sidebar-brand">
          <i class="bi bi-lightning-charge-fill"></i>
          <h4>SmartPJU Monitor</h4>
        </div>
        <ul class="nav-menu">
          <li class="nav-item">
            <a href="/" class="nav-link">
              <i class="bi bi-grid-fill"></i>
              <span>Dashboard</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="/cctv" class="nav-link active">
              <i class="bi bi-camera-video-fill"></i>
              <span>CCTV</span>
            </a>
          </li>
        </ul>
      </aside>

      <!-- Main Content -->
      <main class="main-content">
        <!-- Left Section - Video -->
        <div class="video-section">
          <!-- Top Bar -->
          <div class="top-bar">
            <div class="location-info">
              <i class="bi bi-geo-alt-fill"></i>
              PR52+GPQ, Jl. Mariang Emas, Keputih, Kec. Sukolilo, Surabaya, Jawa
              Timur 60111
              <br />
              <small>Lat: -7.29116 | Long: 112.8018236</small>
            </div>
          </div>

          <!-- Page Header -->
          <div class="page-header">
            <h1><i class="bi bi-broadcast"></i> Rekaman Live CCTV</h1>
            <p>Pantau rekaman live kamera CCTV secara realtime.</p>
          </div>

          <!-- Video Card -->
          <div class="video-card">
            <div id="video-container">
              <video id="video-player" controls autoplay muted>
                <source
                  src="/output/playlist.m3u8"
                  type="application/x-mpegURL"
                />
                Browser Anda tidak mendukung video tag.
              </video>
            </div>

            <div class="video-info">
              <div class="info-item">
                <small>Stream URL:</small>
                <div class="value"><code>/output/playlist.m3u8</code></div>
              </div>
              <div class="info-item">
                <small>Format:</small>
                <div class="value">HLS (HTTP Live Streaming)</div>
              </div>
              <div class="info-item">
                <small>Status:</small>
                <div id="stream-status">
                  <span class="status-badge online">
                    <span class="status-dot"></span>
                    Connected
                  </span>
                </div>
              </div>
            </div>

            <div id="error-container" class="error-message d-none">
              <i class="bi bi-exclamation-triangle-fill"></i>
              <strong>Error:</strong> <span id="error-message"></span>
            </div>
          </div>
        </div>

        <!-- Right Section - Stats Sidebar -->
        <div class="stats-sidebar">
          <div class="stat-card">
            <div class="stat-card-header">
              <i class="bi bi-speedometer2"></i>
              <div>
                <h6>FPS STREAMING</h6>
              </div>
            </div>
            <div class="value" id="fps">-- fps</div>
            <div class="subvalue">
              Target: <span id="target-fps">25</span> fps
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-card-header">
              <i class="bi bi-camera-video"></i>
              <div>
                <h6>STATUS KAMERA</h6>
              </div>
            </div>
            <div class="value" style="color: #28a745; font-size: 1.5rem">
              Active
            </div>
            <div class="subvalue">Stream berjalan normal</div>
          </div>

          <div class="stat-card">
            <div class="stat-card-header">
              <i class="bi bi-clock-history"></i>
              <div>
                <h6>UPTIME</h6>
              </div>
            </div>
            <div class="value" style="font-size: 1.8rem" id="uptime">
              00:00:00
            </div>
            <div class="subvalue">Waktu streaming aktif</div>
          </div>

          <div class="stat-card">
            <div class="stat-card-header">
              <i class="bi bi-display"></i>
              <div>
                <h6>RESOLUSI</h6>
              </div>
            </div>
            <div class="value" style="font-size: 1.5rem">1920x1080</div>
            <div class="subvalue">Full HD</div>
          </div>
        </div>
      </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
  </body>
</html>
